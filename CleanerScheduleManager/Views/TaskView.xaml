<Page
    x:Class="CleanerScheduleManager.Views.TaskView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    Title="TaskView">

    <materialDesign:ColorZone
        Mode="PrimaryLight"
        HorizontalAlignment="Stretch"
        VerticalAlignment="Stretch">
        <StackPanel
            Margin="20">

            <TextBlock
                Text="Cleaning Tasks"
                Margin="0 0 0 10"
                Style="{StaticResource MaterialDesignHeadline5TextBlock}" />

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.Resources>
                    <Style TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
                        <Setter Property="Margin" Value="0 0 10 0" />
                    </Style>
                </Grid.Resources>

                <StackPanel
        Orientation="Horizontal">
                    <Button
            Command="{Binding AddTaskCommand}">
                        <StackPanel
                Orientation="Horizontal">
                            <materialDesign:PackIcon
                    Kind="Plus"
                    Margin="0 0 4 0"
                    VerticalAlignment="Center" />
                            <TextBlock
                    Text="Add" />
                        </StackPanel>
                    </Button>
                    <Button
            Command="{Binding DeleteTaskCommand}">
                        <StackPanel
                Orientation="Horizontal">
                            <materialDesign:PackIcon
                    Kind="Delete"
                    Margin="0 0 4 0"
                    VerticalAlignment="Center" />
                            <TextBlock
                    Text="Delete" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <materialDesign:Chip
        Grid.Column="1"
        Content="{Binding TasksView.Count, StringFormat='Total Tasks: {0}'}"
        IsEnabled="False"
        HorizontalAlignment="Right"
        VerticalAlignment="Center" />
            </Grid>

            <TextBox
    Margin="0 10 0 0"
    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
    materialDesign:HintAssist.Hint="Search"
    materialDesign:TextFieldAssist.HasLeadingIcon="True"
    materialDesign:TextFieldAssist.LeadingIcon="Magnify"
    Style="{StaticResource MaterialDesignFilledTextBox}"
    Background="White"
    Opacity="0.7"/>

            <DataGrid
                ItemsSource="{Binding Tasks}"
                SelectedItem="{Binding SelectedTask}"
                AutoGenerateColumns="False"
                Margin="0 10 0 0"
                CanUserAddRows="False"
                Style="{StaticResource MaterialDesignDataGrid}">

                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow" BasedOn="{StaticResource MaterialDesignDataGridRow}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Status}" Value="Scheduled">
                                <Setter Property="Background" Value="#FFE0B2" />
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Status}" Value="Completed">
                                <Setter Property="Background" Value="#C8E6C9" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>

                <DataGrid.Columns>
                    <DataGridTextColumn
                        Header="Task ID"
                        Binding="{Binding TaskId}" />
                    <DataGridComboBoxColumn
                        Header="Client"
                        SelectedItemBinding="{Binding Client, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        DisplayMemberPath="Name"
                        ClipboardContentBinding="{Binding Client.Name}">
                        <DataGridComboBoxColumn.ElementStyle>
                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="ItemsSource"
                                        Value="{Binding DataContext.Clients, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                            </Style>
                        </DataGridComboBoxColumn.ElementStyle>
                        <DataGridComboBoxColumn.EditingElementStyle>
                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="ItemsSource"
                                        Value="{Binding DataContext.Clients, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                            </Style>
                        </DataGridComboBoxColumn.EditingElementStyle>
                    </DataGridComboBoxColumn>
                    <DataGridComboBoxColumn
                        Header="Cleaner"
                        SelectedItemBinding="{Binding Cleaner, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        DisplayMemberPath="Name"
                        ClipboardContentBinding="{Binding Cleaner.Name}">
                        <DataGridComboBoxColumn.ElementStyle>
                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="ItemsSource"
                                        Value="{Binding DataContext.Cleaners, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                            </Style>
                        </DataGridComboBoxColumn.ElementStyle>
                        <DataGridComboBoxColumn.EditingElementStyle>
                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="ItemsSource"
                                        Value="{Binding DataContext.Cleaners, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                            </Style>
                        </DataGridComboBoxColumn.EditingElementStyle>
                    </DataGridComboBoxColumn>
                    <DataGridTextColumn
                        Header="Date"
                        Binding="{Binding ScheduledDate}" />
                    <DataGridTextColumn
                        Header="Duration"
                        Binding="{Binding Duration}" />
                    <DataGridComboBoxColumn
                        Header="Status"
                        SelectedItemBinding="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <DataGridComboBoxColumn.ElementStyle>
                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="ItemsSource"
                                        Value="{Binding DataContext.TaskStatuses, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                            </Style>
                        </DataGridComboBoxColumn.ElementStyle>
                        <DataGridComboBoxColumn.EditingElementStyle>
                            <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
                                <Setter Property="ItemsSource"
                                        Value="{Binding DataContext.TaskStatuses, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
                            </Style>
                        </DataGridComboBoxColumn.EditingElementStyle>
                    </DataGridComboBoxColumn>
                </DataGrid.Columns>
            </DataGrid>
        </StackPanel>
    </materialDesign:ColorZone>
</Page>